% for moment equation
 hW(:,:,1) = (1./rho(:,:)).*(xi_x(:,:).*hWx(:,:,3) + zt_x(:,:).*hWz(:,:,3)...
     + xi_z(:,:).*hWx(:,:,5) + zt_z(:,:).*hWz(:,:,5));

 hW(:,:,2) = (1./rho(:,:)).*(xi_x(:,:).*hWx(:,:,5) + zt_x(:,:).*hWz(:,:,5)...
     + xi_z(:,:).*hWx(:,:,4) + zt_z(:,:).*hWz(:,:,4));


 % for Hooke's equation
 hW(:,:,3) = lam2mu(:,:).*(xi_x(:,:).*hWx(:,:,1))...
     + lam2mu(:,:).*(zt_x(:,:).*hWz(:,:,1))...
     +lam(:,:).*xi_z(:,:).*hWx(:,:,2)...
     + lam(:,:).*zt_z(:,:).*hWz(:,:,2);

 hW(:,:,4) = lam(:,:).*(xi_x(:,:).*hWx(:,:,1))...
     + lam(:,:).*(zt_x(:,:).*hWz(:,:,1))...
     + lam2mu(:,:).*xi_z(:,:).*hWx(:,:,2)...
     + lam2mu(:,:).*zt_z(:,:).*hWz(:,:,2);

 hW(:,:,5) = mu(:,:).*(xi_z(:,:).*hWx(:,:,1)...
     + xi_x(:,:).*hWx(:,:,2)...
     + zt_z(:,:).*hWz(:,:,1)...
     + zt_x(:,:).*hWz(:,:,2))  ;
